!function e(t,n,r){function o(u,c){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!c&&s)return s(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return o(n?n:e)},a,a.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(){},{}],2:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,n){"use strict";function r(e){for(var t in e)return!1;return!0}function o(e,t){return t.$createdAt=(new Date).toJSON(),e.post(t)}function i(e,t){var n={},r=!1;for(var o in t)e[o]!==t[o]&&(r=!0,n[o]=t[o],e[o]=t[o]);return r?n:null}function u(e,t){return e.get(t).then(function(t){return e.remove(t)})["catch"](function(e){if(404!==e.status)throw e})}function c(e,t,n){var r=[];return t.rows.forEach(function(t){n[t.doc.$id]&&r.push(u(e,t.id))}),f.all(r)}function s(e,t,r,o){return e.get(t.doc._id).then(function(i){if(t.doc.$id||(t.doc.$id=t.doc._id),t.doc.$deleted||o[t.doc.$id])return o[t.doc.$id]=!0,e.remove(i);if(r[t.doc.$id]){var u=!1;for(var c in t.doc)if("undefined"==typeof r[t.doc.$id][c]){u=!0;break}if(!u)return e.remove(i);r[t.doc.$id]=n.merge(r[t.doc.$id],t.doc)}else r[t.doc.$id]=t.doc})}var a=e("./pouch-utils"),f=a.Promise;n.clone=function(e){return JSON.parse(JSON.stringify(e))},n.merge=function(e,t){var n={};for(var r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n},n.save=function(e){return o(this,e)},n["delete"]=function(e){return o(this,{$id:e,$deleted:!0})},n.all=function(){var e=this,t={},r={};return e.allDocs({include_docs:!0}).then(function(e){return e.rows.sort(function(e,t){return e.doc.$createdAt>t.doc.$createdAt}),e.rows.forEach(function(e){e.doc.$id||(e.doc.$id=e.doc._id),e.doc.$deleted?(delete t[e.doc.$id],r[e.doc.$id]=!0):r[e.doc.$id]||(t[e.doc.$id]=t[e.doc.$id]?n.merge(t[e.doc.$id],e.doc):e.doc)}),t})},n.onCreate=function(e,t,n,r,o,i){var u=this;u.get(e.id).then(function(e){if(e.$id=e.$id?e.$id:e._id,!n[e.$id]){var c=t(e.$id);c?e.$deleted?(n[e.$id]=!0,i(e.$id)):o(u.merge(c,e)):e.$deleted?n[e.$id]=!0:r(e)}})},n.saveChanges=function(e,t){var n=this,r=i(e,t);return null!==r?(r.$id=e.$id,n.save(r).then(function(){return e})):f.resolve()},n.getAndRemove=function(e){return u(this,e)},n.cleanup=function(){var e=this;return e.allDocs({include_docs:!0}).then(function(t){var n={},o={},i=f.resolve();return t.rows.sort(function(e,t){return e.doc.$createdAt<t.doc.$createdAt}),t.rows.forEach(function(t){i=i.then(function(){return s(e,t,n,o)})}),i.then(function(){return r(o)?void 0:c(e,t,o)})})},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":22}],4:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],5:[function(e,t){"use strict";function n(){}t.exports=n},{}],6:[function(e,t){"use strict";var n=e("./promise"),r=e("./reject"),o=e("./resolve"),i=e("./INTERNAL"),u=e("./handlers"),c=r(new TypeError("must be an array"));t.exports=function(e){function t(e,t){function n(e){a[t]=e,++f===r&!s&&(s=!0,u.resolve(l,a))}o(e).then(n,function(e){s||(s=!0,u.reject(l,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return c;var r=e.length,s=!1;if(!r)return o([]);for(var a=new Array(r),f=0,d=-1,l=new n(i);++d<r;)t(e[d],d);return l}},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":11,"./resolve":12}],7:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),i=e("./resolveThenable"),u=e("./states");n.resolve=function(e,t){var c=o(r,t);if("error"===c.status)return n.reject(e,c.value);var s=c.value;if(s)i.safely(e,s);else{e.state=u.FULFILLED,e.outcome=t;for(var a=-1,f=e.queue.length;++a<f;)e.queue[a].callFulfilled(t)}return e},n.reject=function(e,t){e.state=u.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":13,"./states":14,"./tryCatch":15}],8:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all")},{"./all":6,"./promise":9,"./reject":11,"./resolve":12}],9:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=u.PENDING,this.queue=[],this.outcome=void 0,e!==o&&i.safely(this,e)}var r=e("./unwrap"),o=e("./INTERNAL"),i=e("./resolveThenable"),u=e("./states"),c=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===u.FULFILLED||"function"!=typeof t&&this.state===u.REJECTED)return this;var i=new n(o);if(this.state!==u.PENDING){var s=this.state===u.FULFILLED?e:t;r(i,s,this.outcome)}else this.queue.push(new c(i,e,t));return i}},{"./INTERNAL":5,"./queueItem":10,"./resolveThenable":13,"./states":14,"./unwrap":16}],10:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var r=e("./handlers"),o=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){r.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},{"./handlers":7,"./unwrap":16}],11:[function(e,t){"use strict";function n(e){var t=new r(o);return i.reject(t,e)}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9}],12:[function(e,t){"use strict";function n(e){if(e)return e instanceof r?e:i.resolve(new r(o),e);var t=typeof e;switch(t){case"boolean":return u;case"undefined":return s;case"object":return c;case"number":return a;case"string":return f}}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n;var u=i.resolve(new r(o),!1),c=i.resolve(new r(o),null),s=i.resolve(new r(o),void 0),a=i.resolve(new r(o),0),f=i.resolve(new r(o),"")},{"./INTERNAL":5,"./handlers":7,"./promise":9}],13:[function(e,t,n){"use strict";function r(e,t){function n(t){c||(c=!0,o.reject(e,t))}function r(t){c||(c=!0,o.resolve(e,t))}function u(){t(r,n)}var c=!1,s=i(u);"error"===s.status&&n(s.value)}var o=e("./handlers"),i=e("./tryCatch");n.safely=r},{"./handlers":7,"./tryCatch":15}],14:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],15:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=n},{}],16:[function(e,t){"use strict";function n(e,t,n){r(function(){var r;try{r=t(n)}catch(i){return o.reject(e,i)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var r=e("immediate"),o=e("./handlers");t.exports=n},{"./handlers":7,immediate:17}],17:[function(e,t){"use strict";function n(){o=!0;for(var e,t,n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}o=!1}function r(e){1!==c.push(e)||o||i()}for(var o,i,u=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],c=[],s=-1,a=u.length;++s<a;)if(u[s]&&u[s].test&&u[s].test()){i=u[s].install(n);break}t.exports=r},{"./messageChannel":18,"./mutation.js":19,"./nextTick":1,"./stateChange":20,"./timeout":21}],18:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return r.setImmediate?!1:"undefined"!=typeof r.MessageChannel},n.install=function(e){var t=new r.MessageChannel;return t.port1.onmessage=e,function(){t.port2.postMessage(0)}}},{}],19:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},o=r.MutationObserver||r.WebKitMutationObserver;n.test=function(){return o},n.install=function(e){var t=0,n=new o(e),i=r.document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}},{}],20:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return"document"in r&&"onreadystatechange"in r.document.createElement("script")},n.install=function(e){return function(){var t=r.document.createElement("script");return t.onreadystatechange=function(){e(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},r.document.documentElement.appendChild(t),e}}},{}],21:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],22:[function(e,t,n){var r,o=e("__browserify_process"),i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};r="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof i.Promise?i.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(t){var i,u=this,c="function"==typeof t[t.length-1]?t.pop():!1;c&&(i=function(e,t){o.nextTick(function(){c(e,t)})});var s=new r(function(r,o){try{var i=n.once(function(e,t){e?o(e):r(t)});t.push(i),e.apply(u,t)}catch(c){o(c)}});return i&&s.then(function(e){i(null,e)},i),s.cancel=function(){return this},s})},n.inherits=e("inherits"),n.Promise=r},{__browserify_process:2,inherits:4,lie:8}]},{},[3]);